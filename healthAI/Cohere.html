<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cohere API Demo</title>
    <link rel="responses" href="api.js">
</head>
<body>

<h1>Cohere API Demo</h1>
<div id="classification-result"></div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Fetch the user messages from local storage
        const messages = JSON.parse(localStorage.getItem('userMessages')) || [];

        // Prepare examples for Cohere API
        const examples = messages.map(message => ({ text: message.message, label: 'neutral' }));

        // Make an API request to Cohere for analysis
        fetch('https://api.cohere.ai/v1/classify', {
            method: 'POST',
            url: "/api/v1/classify",
            contentType: "application/json",
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'oMAjSR2qS6SCrobemgS3a2t55ZSGSE5Xu6d8dNoN',
            },
            body: JSON.stringify({ examples: examples }),
        })
        .then(response => response.json())
        .then(data => {
            // Handle the response data as needed
            console.log("Successfully retrieved the data");
            console.log(data);

            // Display the analysis result
            const resultElement = document.getElementById('classification-result');
            resultElement.innerText = `Analysis Result: ${data.predictions[0].label}`;
        })
        .catch(error => console.error('Error:', error));
    });
</script>

</body>
</html>
